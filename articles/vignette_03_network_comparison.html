<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BioNERO">
<title>Network comparison: consensus modules and module preservation • BioNERO</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Atkinson_Hyperlegible-0.4.5/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.5/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Network comparison: consensus modules and module preservation">
<meta property="og:description" content="BioNERO">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-#0092ac"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BioNERO</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignette_01_GCN_inference.html">Gene coexpression network inference</a>
    <a class="dropdown-item" href="../articles/vignette_02_GRN_inference.html">Gene regulatory network inference</a>
    <a class="dropdown-item" href="../articles/vignette_03_network_comparison.html">Network comparison: consensus modules and module preservation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/almeidasilvaf/BioNERO/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Network comparison: consensus modules and module preservation</h1>
                        <h4 data-toc-skip class="author">Fabricio
Almeida-Silva</h4>
            <address class="author_afil">
      Universidade Estadual do Norte Fluminense Darcy Ribeiro, RJ,
Brazil<br><h4 data-toc-skip class="author">Thiago
Motta Venancio</h4>
            <address class="author_afil">
      Universidade Estadual do Norte Fluminense Darcy Ribeiro, RJ,
Brazil<br><small class="dont-index">Source: <a href="https://github.com/almeidasilvaf/BioNERO/blob/HEAD/vignettes/vignette_03_network_comparison.Rmd" class="external-link"><code>vignettes/vignette_03_network_comparison.Rmd</code></a></small>
      <div class="d-none name"><code>vignette_03_network_comparison.Rmd</code></div>
    </address>
</address>
</div>

    
    
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">'BiocManager'</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'BiocManager'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"BioNERO"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load package after installation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/almeidasilvaf/BioNERO" class="external-link">BioNERO</a></span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span> <span class="co"># for reproducibility</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Comparing different coexpression networks can reveal relevant
biological patterns. For instance, seeking for <strong>consensus
modules</strong> can identify coexpression modules that occur in all
data sets regardless of natural variation and, hence, are core players
of the studied phenotype. Additionally, <strong>module
preservation</strong> within and across species can reveal patterns of
conservation and divergence between transcriptomes. In this vignette, we
will explore consensus modules and module preservation analyses with
<code>BioNERO</code>. Although they seem similar, their goals are
opposite: while consensus modules identification focuses on the
commonalities, module preservation focuses on the divergences.</p>
</div>
<div class="section level2">
<h2 id="data-loading-and-description">Data loading and description<a class="anchor" aria-label="anchor" href="#data-loading-and-description"></a>
</h2>
<p>We will use RNA-seq data of maize (<em>Zea mays</em>) and rice
(<em>Oryza sativa</em>) obtained from <span class="citation">Shin et al.
(2020)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">zma.se</span><span class="op">)</span></span>
<span><span class="va">zma.se</span></span>
<span><span class="co">## class: SummarizedExperiment </span></span>
<span><span class="co">## dim: 10802 28 </span></span>
<span><span class="co">## metadata(0):</span></span>
<span><span class="co">## assays(1): ''</span></span>
<span><span class="co">## rownames(10802): ZeamMp030 ZeamMp044 ... Zm00001d054106 Zm00001d054107</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(28): SRX339756 SRX339757 ... SRX2792103 SRX2792104</span></span>
<span><span class="co">## colData names(1): Tissue</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">osa.se</span><span class="op">)</span></span>
<span><span class="va">osa.se</span></span>
<span><span class="co">## class: SummarizedExperiment </span></span>
<span><span class="co">## dim: 7647 27 </span></span>
<span><span class="co">## metadata(0):</span></span>
<span><span class="co">## assays(1): ''</span></span>
<span><span class="co">## rownames(7647): Os01g0100700 Os01g0100900 ... Os12g0641400 Os12g0641500</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(27): SRX831140 SRX831141 ... SRX263041 SRX1544234</span></span>
<span><span class="co">## colData names(1): Tissue</span></span></code></pre></div>
<p>All <code>BioNERO</code>’s functions for consensus modules and module
preservation analyses require the expression data to be in a
<strong>list</strong>. Each element of the list can be a
SummarizedExperiment object (recommended) or an expression data frame
with genes in row names and samples in column names.</p>
</div>
<div class="section level2">
<h2 id="consensus-modules">Consensus modules<a class="anchor" aria-label="anchor" href="#consensus-modules"></a>
</h2>
<p>The most common objective in consensus modules identification is to
find core modules across different tissues or treatments for the same
species. For instance, one can infer GCNs for different types of cancer
in human tissues (say prostate and liver) and identify modules that
occur in all sets, which are likely core components of cancer biology.
Likewise, one can also identify consensus modules across samples from
different geographical origins to find modules that are not affected by
population structure or kinship.</p>
<div class="section level3">
<h3 id="data-preprocessing">Data preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing"></a>
</h3>
<p>Here, we will subset 22 random samples from the maize data twice and
find consensus modules between the two sets.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Preprocess data and keep top 2000 genes with highest variances</span></span>
<span><span class="va">filt_zma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exp_preprocess.html">exp_preprocess</a></span><span class="op">(</span><span class="va">zma.se</span>, variance_filter <span class="op">=</span> <span class="cn">TRUE</span>, n <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co">## Number of removed samples: 1</span></span>
<span></span>
<span><span class="co"># Create different subsets by resampling data</span></span>
<span><span class="va">zma_set1</span> <span class="op">&lt;-</span> <span class="va">filt_zma</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">filt_zma</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">22</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">zma_set2</span> <span class="op">&lt;-</span> <span class="va">filt_zma</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">filt_zma</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">22</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">zma_set1</span><span class="op">)</span></span>
<span><span class="co">##  [1] "SRX3804716" "SRX2792102" "SRX2527287" "SRX2792108" "SRX3804723"</span></span>
<span><span class="co">##  [6] "SRX2792107" "SRX2792103" "SRX2792104" "SRX3804715" "SRX339808" </span></span>
<span><span class="co">## [11] "SRX339758"  "SRX339756"  "SRX339809"  "SRX2792105" "SRX339757" </span></span>
<span><span class="co">## [16] "SRX2641029" "SRX339762"  "SRX2792110" "SRX339807"  "SRX3804718"</span></span>
<span><span class="co">## [21] "ERX2154032" "SRX339764"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">zma_set2</span><span class="op">)</span></span>
<span><span class="co">##  [1] "SRX2792111" "SRX339756"  "SRX3804715" "SRX2792108" "SRX2792103"</span></span>
<span><span class="co">##  [6] "SRX339762"  "SRX339807"  "ERX2154030" "SRX2792105" "SRX2792107"</span></span>
<span><span class="co">## [11] "SRX2527287" "ERX2154032" "SRX2792104" "SRX2527288" "SRX339809" </span></span>
<span><span class="co">## [16] "SRX3804718" "SRX3804716" "SRX2792109" "SRX3804723" "SRX2792102"</span></span>
<span><span class="co">## [21] "SRX339808"  "SRX339758"</span></span>
<span></span>
<span><span class="co"># Create list</span></span>
<span><span class="va">zma_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>set1 <span class="op">=</span> <span class="va">zma_set1</span>, set2 <span class="op">=</span> <span class="va">zma_set2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">zma_list</span><span class="op">)</span></span>
<span><span class="co">## [1] 2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="identification-of-consensus-modules">Identification of consensus modules<a class="anchor" aria-label="anchor" href="#identification-of-consensus-modules"></a>
</h3>
<p>As described in the first vignette, before inferring the GCNs, we
need to identify the optimal <span class="math inline">\(\beta\)</span>
power that makes the network closer to a scale-free topology. We can do
that with <code><a href="../reference/consensus_SFT_fit.html">consensus_SFT_fit()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cons_sft</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consensus_SFT_fit.html">consensus_SFT_fit</a></span><span class="op">(</span><span class="va">zma_list</span>, setLabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Maize 1"</span>, <span class="st">"Maize 2"</span><span class="op">)</span>,</span>
<span>                              cor_method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="co">##    Power SFT.R.sq  slope truncated.R.sq mean.k. median.k. max.k.</span></span>
<span><span class="co">## 1      5    0.658 -0.650          0.656  107.00     90.50  304.0</span></span>
<span><span class="co">## 2      6    0.761 -0.706          0.774   79.70     62.90  244.0</span></span>
<span><span class="co">## 3      7    0.833 -0.757          0.863   61.30     45.10  200.0</span></span>
<span><span class="co">## 4      8    0.825 -0.830          0.868   48.30     32.80  169.0</span></span>
<span><span class="co">## 5      9    0.822 -0.916          0.887   38.70     24.50  145.0</span></span>
<span><span class="co">## 6     10    0.838 -0.975          0.910   31.50     18.90  126.0</span></span>
<span><span class="co">## 7     11    0.824 -1.040          0.914   26.00     15.00  111.0</span></span>
<span><span class="co">## 8     12    0.837 -1.090          0.932   21.70     12.20   97.6</span></span>
<span><span class="co">## 9     13    0.851 -1.130          0.944   18.30     10.10   86.6</span></span>
<span><span class="co">## 10    14    0.842 -1.190          0.941   15.50      8.42   77.3</span></span>
<span><span class="co">## 11    15    0.844 -1.230          0.947   13.30      7.17   69.4</span></span>
<span><span class="co">## 12    16    0.842 -1.270          0.951   11.50      6.13   62.5</span></span>
<span><span class="co">## 13    17    0.855 -1.300          0.962    9.99      5.24   56.5</span></span>
<span><span class="co">## 14    18    0.864 -1.320          0.967    8.73      4.54   51.3</span></span>
<span><span class="co">## 15    19    0.869 -1.330          0.970    7.67      3.92   46.7</span></span>
<span><span class="co">## 16    20    0.875 -1.340          0.977    6.78      3.38   42.7</span></span>
<span><span class="co">##    Power SFT.R.sq  slope truncated.R.sq mean.k. median.k. max.k.</span></span>
<span><span class="co">## 1      5    0.592 -0.621          0.574   94.70     82.40  265.0</span></span>
<span><span class="co">## 2      6    0.702 -0.666          0.710   69.90     56.80  209.0</span></span>
<span><span class="co">## 3      7    0.757 -0.713          0.771   53.20     40.30  167.0</span></span>
<span><span class="co">## 4      8    0.829 -0.729          0.853   41.50     29.50  136.0</span></span>
<span><span class="co">## 5      9    0.855 -0.782          0.884   32.90     22.10  113.0</span></span>
<span><span class="co">## 6     10    0.868 -0.826          0.911   26.60     17.20   96.6</span></span>
<span><span class="co">## 7     11    0.873 -0.868          0.931   21.80     13.70   83.2</span></span>
<span><span class="co">## 8     12    0.837 -0.943          0.914   18.10     11.30   73.0</span></span>
<span><span class="co">## 9     13    0.826 -1.000          0.917   15.20      9.30   64.7</span></span>
<span><span class="co">## 10    14    0.815 -1.070          0.917   12.80      7.73   57.6</span></span>
<span><span class="co">## 11    15    0.810 -1.120          0.926   11.00      6.53   51.5</span></span>
<span><span class="co">## 12    16    0.823 -1.150          0.943    9.42      5.45   46.3</span></span>
<span><span class="co">## 13    17    0.815 -1.210          0.942    8.16      4.57   41.8</span></span>
<span><span class="co">## 14    18    0.827 -1.240          0.954    7.11      3.92   37.8</span></span>
<span><span class="co">## 15    19    0.833 -1.260          0.964    6.23      3.42   34.3</span></span>
<span><span class="co">## 16    20    0.831 -1.280          0.965    5.49      2.99   31.2</span></span></code></pre></div>
<p>This function returns a list with the optimal powers and a summary
plot, exactly as <code><a href="../reference/SFT_fit.html">SFT_fit()</a></code> does.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">powers</span> <span class="op">&lt;-</span> <span class="va">cons_sft</span><span class="op">$</span><span class="va">power</span></span>
<span><span class="va">powers</span></span>
<span><span class="co">## set1 set2 </span></span>
<span><span class="co">##    7    8</span></span>
<span><span class="va">cons_sft</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="vignette_03_network_comparison_files/figure-html/sft_results-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Now, we can infer GCNs and identify consensus modules across data
sets.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">consensus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consensus_modules.html">consensus_modules</a></span><span class="op">(</span><span class="va">zma_list</span>, power <span class="op">=</span> <span class="va">powers</span>, cor_method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="co">## ..connectivity..</span></span>
<span><span class="co">## ..matrix multiplication (system BLAS)..</span></span>
<span><span class="co">## ..normalization..</span></span>
<span><span class="co">## ..done.</span></span>
<span><span class="co">## ..connectivity..</span></span>
<span><span class="co">## ..matrix multiplication (system BLAS)..</span></span>
<span><span class="co">## ..normalization..</span></span>
<span><span class="co">## ..done.</span></span>
<span><span class="co">##  ..done.</span></span>
<span><span class="co">##  multiSetMEs: Calculating module MEs.</span></span>
<span><span class="co">##    Working on set 1 ...</span></span>
<span><span class="co">##    Working on set 2 ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">consensus</span><span class="op">)</span></span>
<span><span class="co">## [1] "consModules"         "consMEs"             "exprSize"           </span></span>
<span><span class="co">## [4] "sampleInfo"          "genes_cmodules"      "dendro_plot_objects"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">consensus</span><span class="op">$</span><span class="va">genes_cmodules</span><span class="op">)</span></span>
<span><span class="co">##       Genes Cons_modules</span></span>
<span><span class="co">## 1 ZeamMp030    royalblue</span></span>
<span><span class="co">## 2 ZeamMp044      darkred</span></span>
<span><span class="co">## 3 ZeamMp092      darkred</span></span>
<span><span class="co">## 4 ZeamMp108  saddlebrown</span></span>
<span><span class="co">## 5 ZeamMp116      darkred</span></span>
<span><span class="co">## 6 ZeamMp158  saddlebrown</span></span></code></pre></div>
<p>Finally, we can correlate consensus module eigengenes to sample
metadata (here, plant tissues).<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; Blank grey cells in the heatmap
represent correlation values that have opposite sign in the expression
sets. For each correlation pair, consensus correlations are calculated
by selecting the minimum value across matrices of consensus module-trait
correlations.&lt;/p&gt;"><sup>1</sup></a></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">consensus_trait</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consensus_trait_cor.html">consensus_trait_cor</a></span><span class="op">(</span><span class="va">consensus</span>, cor_method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette_03_network_comparison_files/figure-html/consensus_trait_cor-1.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">consensus_trait</span><span class="op">)</span></span>
<span><span class="co">##        ME          trait          cor    pvalue</span></span>
<span><span class="co">## 1 MEblack      endosperm -0.297224435 0.1815879</span></span>
<span><span class="co">## 2 MEblack         pollen  0.284525339 0.2021641</span></span>
<span><span class="co">## 3 MEblack whole_seedling  0.007301901 0.9746086</span></span>
<span><span class="co">## 4  MEblue      endosperm -0.164695363 0.4687656</span></span>
<span><span class="co">## 5  MEblue         pollen  0.295979347 0.1835410</span></span>
<span><span class="co">## 6  MEblue whole_seedling -0.016437184 0.9428769</span></span></code></pre></div>
<p>Users can also transpose the heatmap as in
<code><a href="../reference/module_trait_cor.html">module_trait_cor()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="module-preservation">Module preservation<a class="anchor" aria-label="anchor" href="#module-preservation"></a>
</h2>
<p>Module preservation is often used to study patterns of evolutionary
conservation and divergence across transcriptomes, an approach named
<em>phylotranscriptomics</em>. This way, one can investigate how
evolution shaped the expression profiles for particular gene families
across taxa.</p>
<div class="section level3">
<h3 id="data-preprocessing-1">Data preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing-1"></a>
</h3>
<p>To calculate module preservation statistics, gene IDs must be shared
by the expression sets. For intraspecies comparisons, this is an easy
task, as gene IDs are the same. However, for interspecies comparisons,
users need to identify orthogroups between the different species and
collapse the gene-level expression values to orthogroup-level expression
values. This way, all expression sets will have common row names. We
recommend identifying orthogroups with <strong>OrthoFinder</strong>
<span class="citation">(Emms and Kelly 2015)</span>, as it is simple to
use and widely used.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;strong&gt;PRO TIP:&lt;/strong&gt; If you identify orthogroups
with &lt;strong&gt;OrthoFinder&lt;/strong&gt;, &lt;code&gt;BioNERO&lt;/code&gt; has a helper
function named &lt;code&gt;&lt;a href="../reference/parse_orthofinder.html"&gt;parse_orthofinder()&lt;/a&gt;&lt;/code&gt; that parses the
&lt;em&gt;Orthogroups.tsv&lt;/em&gt; file generated by OrthoFinder into a suitable
data frame for module preservation analysis. See
&lt;code&gt;&lt;a href="../reference/parse_orthofinder.html"&gt;?parse_orthofinder&lt;/a&gt;&lt;/code&gt; for more details.&lt;/p&gt;'><sup>2</sup></a> Here, we will compare maize and rice
expression profiles. The orthogroups between these species were
downloaded from the PLAZA 4.0 Monocots database <span class="citation">(Van Bel et al. 2018)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">og.zma.osa</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">og.zma.osa</span><span class="op">)</span></span>
<span><span class="co">##              Family Species           Gene</span></span>
<span><span class="co">## 1548 ORTHO04M000001     osa   Os01g0100700</span></span>
<span><span class="co">## 1549 ORTHO04M000001     osa   Os01g0100900</span></span>
<span><span class="co">## 4824 ORTHO04M000001     zma Zm00001d009743</span></span>
<span><span class="co">## 4854 ORTHO04M000001     zma Zm00001d020834</span></span>
<span><span class="co">## 4874 ORTHO04M000001     zma Zm00001d026672</span></span>
<span><span class="co">## 4921 ORTHO04M000001     zma Zm00001d039873</span></span></code></pre></div>
<p>As you can see, the orthogroup object for <code>BioNERO</code> must
be a data frame with orthogroups, species IDs and gene IDs,
respectively. Let’s collapse gene-level expression to orthogroup-level
with <code><a href="../reference/exp_genes2orthogroups.html">exp_genes2orthogroups()</a></code>. By default, if there is more
than one gene in the same orthogroup for a given species, their
expression levels are summarized to the median. Users can also summarize
to the mean.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Store SummarizedExperiment objects in a list</span></span>
<span><span class="va">zma_osa_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>osa <span class="op">=</span> <span class="va">osa.se</span>, zma <span class="op">=</span> <span class="va">zma.se</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Collapse gene-level expression to orthogroup-level</span></span>
<span><span class="va">ortho_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exp_genes2orthogroups.html">exp_genes2orthogroups</a></span><span class="op">(</span><span class="va">zma_osa_list</span>, <span class="va">og.zma.osa</span>, summarize <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect new expression data</span></span>
<span><span class="va">ortho_exp</span><span class="op">$</span><span class="va">osa</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">##                SRX831140 SRX831141 SRX831137 SRX831138 SRX831134</span></span>
<span><span class="co">## ORTHO04M000001  6.909420  7.258330  94.20870  92.85195 123.01060</span></span>
<span><span class="co">## ORTHO04M000002  9.203498  8.709974  66.45512  44.97913  33.86936</span></span>
<span><span class="co">## ORTHO04M000003  9.417930  9.444861  42.57513  66.02237  55.37741</span></span>
<span><span class="co">## ORTHO04M000004  9.019436  8.920091  96.22074  62.56506 109.32262</span></span>
<span><span class="co">## ORTHO04M000005 40.845040 41.844234  52.33474  31.31474  22.42236</span></span>
<span><span class="va">ortho_exp</span><span class="op">$</span><span class="va">zma</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">##                SRX339756 SRX339757 SRX339758 SRX339762 SRX339763</span></span>
<span><span class="co">## ORTHO04M000001  26.02510  15.07917  14.91571  13.82989  8.080476</span></span>
<span><span class="co">## ORTHO04M000002  19.28281  13.94254  13.57854  12.96032 13.522525</span></span>
<span><span class="co">## ORTHO04M000003  45.17294  48.63796  54.22404  42.12135 10.779117</span></span>
<span><span class="co">## ORTHO04M000004  28.05475  38.53734  39.48070  27.13272  2.978207</span></span>
<span><span class="co">## ORTHO04M000005  67.58868  34.87009  21.46280  12.79565  7.452068</span></span></code></pre></div>
<p>Now, we will preprocess both expression sets and keep only the top
1000 orthogroups with the highest variances for demonstration
purposes.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Preprocess data and keep top 1000 genes with highest variances</span></span>
<span><span class="va">ortho_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ortho_exp</span>, <span class="va">exp_preprocess</span>, variance_filter<span class="op">=</span><span class="cn">TRUE</span>, n<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">## Number of removed samples: 2</span></span>
<span><span class="co">## Number of removed samples: 2</span></span>
<span></span>
<span><span class="co"># Check orthogroup number</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ortho_exp</span>, <span class="va">nrow</span><span class="op">)</span></span>
<span><span class="co">##  osa  zma </span></span>
<span><span class="co">## 1000 1000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculating-module-preservation-statistics">Calculating module preservation statistics<a class="anchor" aria-label="anchor" href="#calculating-module-preservation-statistics"></a>
</h3>
<p>Now that row names are comparable, we can infer GCNs for each set. We
will do that iteratively with lapply.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate SFT power</span></span>
<span><span class="va">power_ortho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ortho_exp</span>, <span class="va">SFT_fit</span>, cor_method<span class="op">=</span><span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="co">##    Power SFT.R.sq  slope truncated.R.sq mean.k. median.k. max.k.</span></span>
<span><span class="co">## 1      3  0.15600  1.740          0.846  191.00    192.00  249.0</span></span>
<span><span class="co">## 2      4  0.12400  1.080          0.844  129.00    130.00  178.0</span></span>
<span><span class="co">## 3      5  0.10300  0.784          0.817   91.70     92.90  134.0</span></span>
<span><span class="co">## 4      6  0.06140  0.528          0.818   67.80     68.90  106.0</span></span>
<span><span class="co">## 5      7  0.04550  0.397          0.803   51.80     52.60   85.5</span></span>
<span><span class="co">## 6      8  0.02660  0.234          0.840   40.70     40.80   70.7</span></span>
<span><span class="co">## 7      9  0.00989  0.121          0.868   32.60     32.50   59.8</span></span>
<span><span class="co">## 8     10  0.04090 -0.274          0.820   26.70     26.10   53.2</span></span>
<span><span class="co">## 9     11  0.12200 -0.458          0.871   22.20     21.40   47.8</span></span>
<span><span class="co">## 10    12  0.20600 -0.600          0.908   18.80     18.00   43.4</span></span>
<span><span class="co">## 11    13  0.27900 -0.688          0.928   16.00     15.30   39.7</span></span>
<span><span class="co">## 12    14  0.39900 -0.839          0.952   13.80     13.10   36.4</span></span>
<span><span class="co">## 13    15  0.48600 -0.949          0.951   12.10     11.30   33.6</span></span>
<span><span class="co">## 14    16  0.55500 -1.010          0.959   10.60      9.71   31.2</span></span>
<span><span class="co">## 15    17  0.59600 -1.080          0.959    9.39      8.34   29.0</span></span>
<span><span class="co">## 16    18  0.64700 -1.130          0.965    8.37      7.20   27.1</span></span>
<span><span class="co">## 17    19  0.68300 -1.120          0.969    7.50      6.28   25.3</span></span>
<span><span class="co">## 18    20  0.72300 -1.120          0.979    6.76      5.52   23.8</span></span>
<span><span class="co">## No power reached R-squared cut-off, now choosing max R-squared based power</span></span>
<span><span class="co">##    Power SFT.R.sq   slope truncated.R.sq mean.k. median.k. max.k.</span></span>
<span><span class="co">## 1      3   0.6910  0.7290         0.6260   269.0     284.0  407.0</span></span>
<span><span class="co">## 2      4   0.4540  0.3460         0.3270   199.0     209.0  329.0</span></span>
<span><span class="co">## 3      5   0.0802  0.1070        -0.0486   153.0     158.0  273.0</span></span>
<span><span class="co">## 4      6   0.0459 -0.0746        -0.0302   121.0     123.0  233.0</span></span>
<span><span class="co">## 5      7   0.2620 -0.2140         0.3480    98.1      97.1  201.0</span></span>
<span><span class="co">## 6      8   0.4070 -0.3270         0.4820    80.7      78.1  176.0</span></span>
<span><span class="co">## 7      9   0.5030 -0.4180         0.5960    67.4      63.4  155.0</span></span>
<span><span class="co">## 8     10   0.4930 -0.4950         0.5950    57.0      52.5  138.0</span></span>
<span><span class="co">## 9     11   0.5730 -0.5520         0.6790    48.8      43.8  124.0</span></span>
<span><span class="co">## 10    12   0.5770 -0.6090         0.6860    42.1      37.2  112.0</span></span>
<span><span class="co">## 11    13   0.6560 -0.6500         0.7490    36.7      31.6  101.0</span></span>
<span><span class="co">## 12    14   0.6740 -0.7010         0.7630    32.2      27.5   92.1</span></span>
<span><span class="co">## 13    15   0.7240 -0.7330         0.7930    28.4      23.8   84.2</span></span>
<span><span class="co">## 14    16   0.7800 -0.7460         0.8470    25.3      20.6   77.3</span></span>
<span><span class="co">## 15    17   0.8330 -0.7540         0.9060    22.6      18.0   71.2</span></span>
<span><span class="co">## 16    18   0.8560 -0.7740         0.9200    20.3      15.8   65.7</span></span>
<span><span class="co">## 17    19   0.8690 -0.7870         0.9320    18.3      13.9   60.9</span></span>
<span><span class="co">## 18    20   0.8810 -0.8120         0.9240    16.6      12.3   56.6</span></span>
<span></span>
<span><span class="co"># Infer GCNs</span></span>
<span><span class="va">gcns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">power_ortho</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> </span>
<span>  <span class="fu"><a href="../reference/exp2gcn.html">exp2gcn</a></span><span class="op">(</span><span class="va">ortho_exp</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span>, SFTpower <span class="op">=</span> <span class="va">power_ortho</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">power</span>, </span>
<span>          cor_method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">## ..connectivity..</span></span>
<span><span class="co">## ..matrix multiplication (system BLAS)..</span></span>
<span><span class="co">## ..normalization..</span></span>
<span><span class="co">## ..done.</span></span>
<span><span class="co">## ..connectivity..</span></span>
<span><span class="co">## ..matrix multiplication (system BLAS)..</span></span>
<span><span class="co">## ..normalization..</span></span>
<span><span class="co">## ..done.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gcns</span><span class="op">)</span></span>
<span><span class="co">## [1] 2</span></span></code></pre></div>
<p>Initially, module preservation analyses were performed with WGCNA’s
algorithm <span class="citation">(Langfelder and Horvath 2008)</span>.
However, the summary preservation statistics used by WGCNA rely on
parametric assumptions that are often not met. For this purpose, the
NetRep algorithm <span class="citation">(Ritchie et al. 2016)</span> is
more accurate than WGCNA, as it uses non-parametric permutation
analyses. Both algorithms are implemented in <code>BioNERO</code> for
comparison purposes, but we <strong>strongly recommend</strong> using
the NetRep algorithm. Module preservation analysis can be performed with
a single function: <code><a href="../reference/module_preservation.html">module_preservation()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using rice as reference and maize as test</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>pres <span class="ot">&lt;-</span> <span class="fu">module_preservation</span>(ortho_exp, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ref_net =</span> gcns[[<span class="dv">1</span>]], </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">test_net =</span> gcns[[<span class="dv">2</span>]], </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">algorithm =</span> <span class="st">"netrep"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [2023-03-23 10:04:56 UTC] Validating user input...</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [2023-03-23 10:04:56 UTC]   Checking matrices for problems...</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [2023-03-23 10:04:56 UTC] Input ok!</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [2023-03-23 10:04:57 UTC] Calculating preservation of network subsets from</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="do">##                           dataset "osa" in dataset "zma".</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [2023-03-23 10:04:57 UTC]   Pre-computing network properties in dataset</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="do">##                             "osa"...</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [2023-03-23 10:04:57 UTC]   Calculating observed test statistics...</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [2023-03-23 10:04:57 UTC]   Generating null distributions from 1000</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="do">##                             permutations using 1 thread...</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>% completed.</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">100</span>% completed.</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="do">## [2023-03-23 10:04:58 UTC]   Calculating P-values...</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="do">## [2023-03-23 10:04:59 UTC]   Collating results...</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="do">## [2023-03-23 10:05:00 UTC] Done!</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 modules in osa were preserved in zma:</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="do">## NA</span></span></code></pre></div>
<p>None of the modules in rice were preserved in maize. This can be
either due to the small number of orthogroups we have chosen or to the
natural biological variation between species and sampled tissues. You
can (and should) include more orthogroups in your analyses for a better
view of transcriptional conservation between species.</p>
</div>
</div>
<div class="section level2">
<h2 id="identifying-singletons-and-duplicated-genes">Identifying singletons and duplicated genes<a class="anchor" aria-label="anchor" href="#identifying-singletons-and-duplicated-genes"></a>
</h2>
<p>Finally, <code>BioNERO</code> can identify singletons and duplicated
genes with <code><a href="../reference/is_singleton.html">is_singleton()</a></code>. This function returns logical
vectors indicating if each of the input genes is a singleton or not.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample 50 random genes</span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">zma.se</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_singleton.html">is_singleton</a></span><span class="op">(</span><span class="va">genes</span>, <span class="va">og.zma.osa</span><span class="op">)</span></span>
<span><span class="co">## Zm00001d001841 Zm00001d002104 Zm00001d004006 Zm00001d005944 Zm00001d006390 </span></span>
<span><span class="co">##           TRUE           TRUE           TRUE           TRUE           TRUE </span></span>
<span><span class="co">## Zm00001d008725 Zm00001d008874 Zm00001d009669 Zm00001d011096 Zm00001d011507 </span></span>
<span><span class="co">##           TRUE           TRUE           TRUE           TRUE           TRUE </span></span>
<span><span class="co">## Zm00001d012816 Zm00001d014124 Zm00001d014890 Zm00001d015497 Zm00001d017085 </span></span>
<span><span class="co">##           TRUE           TRUE           TRUE           TRUE           TRUE </span></span>
<span><span class="co">## Zm00001d017275 Zm00001d017654 Zm00001d019718 Zm00001d020807 Zm00001d025222 </span></span>
<span><span class="co">##           TRUE           TRUE           TRUE           TRUE           TRUE </span></span>
<span><span class="co">## Zm00001d028731 Zm00001d030626 Zm00001d031041 Zm00001d031963 Zm00001d032111 </span></span>
<span><span class="co">##           TRUE           TRUE           TRUE           TRUE           TRUE </span></span>
<span><span class="co">## Zm00001d032186 Zm00001d032231 Zm00001d032671 Zm00001d032843 Zm00001d034004 </span></span>
<span><span class="co">##           TRUE           TRUE           TRUE           TRUE           TRUE </span></span>
<span><span class="co">## Zm00001d034713 Zm00001d036482 Zm00001d036651 Zm00001d037613 Zm00001d038937 </span></span>
<span><span class="co">##           TRUE           TRUE           TRUE           TRUE           TRUE </span></span>
<span><span class="co">## Zm00001d038960 Zm00001d039619 Zm00001d042213 Zm00001d043146 Zm00001d043914 </span></span>
<span><span class="co">##           TRUE           TRUE           TRUE           TRUE           TRUE </span></span>
<span><span class="co">## Zm00001d044251 Zm00001d044274 Zm00001d047303 Zm00001d048893 Zm00001d049399 </span></span>
<span><span class="co">##           TRUE           TRUE           TRUE           TRUE           TRUE </span></span>
<span><span class="co">## Zm00001d049617 Zm00001d052078 Zm00001d052888 Zm00001d053016 Zm00001d053962 </span></span>
<span><span class="co">##           TRUE           TRUE           TRUE           TRUE           TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<p>This vignette was created under the following conditions:</p>
<pre><code><span><span class="co">## R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 20.04.4 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] BioNERO_1.7.1    BiocStyle_2.24.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] backports_1.4.1             circlize_0.4.15            </span></span>
<span><span class="co">##   [3] Hmisc_5.0-1                 systemfonts_1.0.4          </span></span>
<span><span class="co">##   [5] plyr_1.8.8                  igraph_1.4.1               </span></span>
<span><span class="co">##   [7] splines_4.2.1               GENIE3_1.18.0              </span></span>
<span><span class="co">##   [9] BiocParallel_1.30.4         GenomeInfoDb_1.32.4        </span></span>
<span><span class="co">##  [11] ggnetwork_0.5.12            ggplot2_3.4.1              </span></span>
<span><span class="co">##  [13] sva_3.44.0                  digest_0.6.31              </span></span>
<span><span class="co">##  [15] foreach_1.5.2               htmltools_0.5.4            </span></span>
<span><span class="co">##  [17] GO.db_3.15.0                fansi_1.0.4                </span></span>
<span><span class="co">##  [19] magrittr_2.0.3              checkmate_2.1.0            </span></span>
<span><span class="co">##  [21] memoise_2.0.1               cluster_2.1.4              </span></span>
<span><span class="co">##  [23] doParallel_1.0.17           limma_3.52.4               </span></span>
<span><span class="co">##  [25] annotate_1.74.0             ComplexHeatmap_2.12.1      </span></span>
<span><span class="co">##  [27] fastcluster_1.2.3           Biostrings_2.64.1          </span></span>
<span><span class="co">##  [29] matrixStats_0.63.0          pkgdown_2.0.7              </span></span>
<span><span class="co">##  [31] colorspace_2.1-0            blob_1.2.4                 </span></span>
<span><span class="co">##  [33] ggrepel_0.9.3               textshaping_0.3.6          </span></span>
<span><span class="co">##  [35] xfun_0.37                   dplyr_1.1.0                </span></span>
<span><span class="co">##  [37] crayon_1.5.2                RCurl_1.98-1.10            </span></span>
<span><span class="co">##  [39] jsonlite_1.8.4              genefilter_1.78.0          </span></span>
<span><span class="co">##  [41] impute_1.70.0               survival_3.5-5             </span></span>
<span><span class="co">##  [43] iterators_1.0.14            glue_1.6.2                 </span></span>
<span><span class="co">##  [45] gtable_0.3.3                zlibbioc_1.42.0            </span></span>
<span><span class="co">##  [47] XVector_0.36.0              GetoptLong_1.0.5           </span></span>
<span><span class="co">##  [49] DelayedArray_0.22.0         shape_1.4.6                </span></span>
<span><span class="co">##  [51] BiocGenerics_0.42.0         abind_1.4-5                </span></span>
<span><span class="co">##  [53] scales_1.2.1                edgeR_3.38.4               </span></span>
<span><span class="co">##  [55] DBI_1.1.3                   Rcpp_1.0.10                </span></span>
<span><span class="co">##  [57] xtable_1.8-4                htmlTable_2.4.1            </span></span>
<span><span class="co">##  [59] clue_0.3-64                 foreign_0.8-84             </span></span>
<span><span class="co">##  [61] bit_4.0.5                   preprocessCore_1.58.0      </span></span>
<span><span class="co">##  [63] Formula_1.2-5               stats4_4.2.1               </span></span>
<span><span class="co">##  [65] htmlwidgets_1.6.2           httr_1.4.5                 </span></span>
<span><span class="co">##  [67] RColorBrewer_1.1-3          farver_2.1.1               </span></span>
<span><span class="co">##  [69] XML_3.99-0.14               pkgconfig_2.0.3            </span></span>
<span><span class="co">##  [71] nnet_7.3-18                 sass_0.4.5                 </span></span>
<span><span class="co">##  [73] locfit_1.5-9.7              utf8_1.2.3                 </span></span>
<span><span class="co">##  [75] dynamicTreeCut_1.63-1       labeling_0.4.2             </span></span>
<span><span class="co">##  [77] tidyselect_1.2.0            rlang_1.1.0                </span></span>
<span><span class="co">##  [79] reshape2_1.4.4              AnnotationDbi_1.58.0       </span></span>
<span><span class="co">##  [81] munsell_0.5.0               tools_4.2.1                </span></span>
<span><span class="co">##  [83] cachem_1.0.7                cli_3.6.0                  </span></span>
<span><span class="co">##  [85] generics_0.1.3              RSQLite_2.3.0              </span></span>
<span><span class="co">##  [87] statnet.common_4.8.0        evaluate_0.20              </span></span>
<span><span class="co">##  [89] stringr_1.5.0               fastmap_1.1.1              </span></span>
<span><span class="co">##  [91] yaml_2.3.7                  ragg_1.2.5                 </span></span>
<span><span class="co">##  [93] RhpcBLASctl_0.23-42         knitr_1.42                 </span></span>
<span><span class="co">##  [95] bit64_4.0.5                 fs_1.6.1                   </span></span>
<span><span class="co">##  [97] purrr_1.0.1                 KEGGREST_1.36.3            </span></span>
<span><span class="co">##  [99] nlme_3.1-162                compiler_4.2.1             </span></span>
<span><span class="co">## [101] rstudioapi_0.14             png_0.1-8                  </span></span>
<span><span class="co">## [103] minet_3.54.0                tibble_3.2.1               </span></span>
<span><span class="co">## [105] statmod_1.5.0               bslib_0.4.2                </span></span>
<span><span class="co">## [107] stringi_1.7.12              highr_0.10                 </span></span>
<span><span class="co">## [109] desc_1.4.2                  lattice_0.20-45            </span></span>
<span><span class="co">## [111] Matrix_1.5-3                vctrs_0.6.0                </span></span>
<span><span class="co">## [113] pillar_1.8.1                lifecycle_1.0.3            </span></span>
<span><span class="co">## [115] networkD3_0.4               BiocManager_1.30.20        </span></span>
<span><span class="co">## [117] jquerylib_0.1.4             GlobalOptions_0.1.2        </span></span>
<span><span class="co">## [119] data.table_1.14.8           bitops_1.0-7               </span></span>
<span><span class="co">## [121] patchwork_1.1.2             GenomicRanges_1.48.0       </span></span>
<span><span class="co">## [123] R6_2.5.1                    bookdown_0.33              </span></span>
<span><span class="co">## [125] network_1.18.1              gridExtra_2.3              </span></span>
<span><span class="co">## [127] IRanges_2.30.1              codetools_0.2-19           </span></span>
<span><span class="co">## [129] SummarizedExperiment_1.26.1 rprojroot_2.0.3            </span></span>
<span><span class="co">## [131] rjson_0.2.21                withr_2.5.0                </span></span>
<span><span class="co">## [133] S4Vectors_0.34.0            GenomeInfoDbData_1.2.8     </span></span>
<span><span class="co">## [135] intergraph_2.0-2            mgcv_1.8-42                </span></span>
<span><span class="co">## [137] parallel_4.2.1              grid_4.2.1                 </span></span>
<span><span class="co">## [139] rpart_4.1.19                NetRep_1.2.6               </span></span>
<span><span class="co">## [141] coda_0.19-4                 rmarkdown_2.20             </span></span>
<span><span class="co">## [143] MatrixGenerics_1.8.1        ggnewscale_0.4.8           </span></span>
<span><span class="co">## [145] Biobase_2.56.0              WGCNA_1.72-1               </span></span>
<span><span class="co">## [147] base64enc_0.1-3</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Emms2015" class="csl-entry">
Emms, David M., and Steven Kelly. 2015. <span>“<span class="nocase">OrthoFinder: solving fundamental biases in whole genome
comparisons dramatically improves orthogroup inference
accuracy</span>.”</span> <em>Genome Biology</em> 16 (1): 1–14. <a href="https://doi.org/10.1186/s13059-015-0721-2" class="external-link">https://doi.org/10.1186/s13059-015-0721-2</a>.
</div>
<div id="ref-Langfelder2008" class="csl-entry">
Langfelder, Peter, and Steve Horvath. 2008. <span>“<span class="nocase">WGCNA: an R package for weighted correlation network
analysis</span>.”</span> <em>BMC Bioinformatics</em> 9 (1): 559. <a href="https://doi.org/10.1186/1471-2105-9-559" class="external-link">https://doi.org/10.1186/1471-2105-9-559</a>.
</div>
<div id="ref-Ritchie2016" class="csl-entry">
Ritchie, Scott C., Stephen Watts, Liam G. Fearnley, Kathryn E. Holt, Gad
Abraham, and Michael Inouye. 2016. <span>“<span class="nocase">A
Scalable Permutation Approach Reveals Replication and Preservation
Patterns of Network Modules in Large Datasets</span>.”</span> <em>Cell
Systems</em> 3 (1): 71–82. <a href="https://doi.org/10.1016/j.cels.2016.06.012" class="external-link">https://doi.org/10.1016/j.cels.2016.06.012</a>.
</div>
<div id="ref-Shin2020" class="csl-entry">
Shin, Junha, Harald Marx, Alicia Richards, Dries Vaneechoutte,
Dhileepkumar Jayaraman, Junko Maeda, Sanhita Chakraborty, et al. 2020.
<span>“<span class="nocase">A network-based comparative framework to
study conservation and divergence of proteomes in plant
phylogenies</span>.”</span> <em>Nucleic Acids Research</em>, 1–23. <a href="https://doi.org/10.1093/nar/gkaa1041" class="external-link">https://doi.org/10.1093/nar/gkaa1041</a>.
</div>
<div id="ref-VanBel2018" class="csl-entry">
Van Bel, Michiel, Tim Diels, Emmelien Vancaester, Lukasz Kreft,
Alexander Botzki, Yves Van De Peer, Frederik Coppens, and Klaas
Vandepoele. 2018. <span>“<span class="nocase">PLAZA 4.0: An integrative
resource for functional, evolutionary and comparative plant
genomics</span>.”</span> <em>Nucleic Acids Research</em> 46 (D1):
D1190–96. <a href="https://doi.org/10.1093/nar/gkx1002" class="external-link">https://doi.org/10.1093/nar/gkx1002</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Fabricio Almeida-Silva, Thiago Venancio.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
